{% extends "base.html" %}

{% block title %}Application Submitted - EFF Membership{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card text-center">
            <div class="card-body py-5">
                <div class="mb-4">
                    <i class="fas fa-check-circle text-success" style="font-size: 5rem;"></i>
                </div>
                
                <h2 class="text-success mb-3">Application Submitted Successfully!</h2>

                <p class="lead mb-4">
                    Thank you for applying to join the Economic Freedom Fighters.
                </p>

                <div class="alert alert-success border-success" style="border-width: 2px !important;">
                    <h4 class="alert-heading mb-3">
                        <i class="fas fa-id-card me-2"></i>Your Application Reference
                    </h4>
                    <h2 class="mb-3 text-success" style="font-size: 2.5rem; font-weight: bold; letter-spacing: 2px;">
                        {{ application_number or ('APP' + '%07d'|format(application_id)) }}
                    </h2>
                    <p class="mb-2">
                        <strong>Please save this reference number for your records.</strong>
                    </p>
                    <p class="mb-0">
                        You can use it to check your application status at any time.
                    </p>
                </div>

                {% if phone_number %}
                <div class="alert alert-info">
                    <i class="fas fa-sms me-2"></i>
                    <strong>SMS Confirmation Sent!</strong><br>
                    An SMS with your application reference has been sent to <strong>{{ phone_number }}</strong>.
                    Please keep this SMS for future reference.
                </div>
                {% endif %}
                
                <div class="card bg-light mb-4">
                    <div class="card-body text-start">
                        <h6 class="card-title">What Happens Next?</h6>
                        <ol class="mb-0">
                            <li>Your application will be reviewed by our membership team</li>
                            <li>If payment verification is required, you will be contacted</li>
                            <li>Once approved, you will receive your membership confirmation</li>
                            <li>Your digital membership card will be available in your member portal</li>
                        </ol>
                    </div>
                </div>
                
                <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                    <a href="{{ url_for('index') }}" class="btn btn-primary">
                        <i class="fas fa-home"></i> Return to Home
                    </a>
                    <a href="{{ url_for('application_status', application_number=application_number or ('APP' + '%07d'|format(application_id))) }}"
                       class="btn btn-outline-success">
                        <i class="fas fa-search"></i> Check Application Status
                    </a>
                </div>

                <div class="mt-3">
                    <button class="btn btn-sm btn-outline-secondary" onclick="copyToClipboard()">
                        <i class="fas fa-copy me-1"></i> Copy Reference Number
                    </button>
                </div>
                
                <hr class="my-4">
                
                <p class="text-muted mb-0">
                    <small>
                        For any questions or concerns, please contact us at 
                        <a href="mailto:membership@eff.org.za">membership@eff.org.za</a>
                    </small>
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    function copyToClipboard() {
        const referenceNumber = "{{ application_number or ('APP' + '%07d'|format(application_id)) }}";

        // Create a temporary textarea element
        const textarea = document.createElement('textarea');
        textarea.value = referenceNumber;
        textarea.style.position = 'fixed';
        textarea.style.opacity = '0';
        document.body.appendChild(textarea);

        // Select and copy the text
        textarea.select();
        document.execCommand('copy');

        // Remove the temporary element
        document.body.removeChild(textarea);

        // Show feedback
        const button = event.target.closest('button');
        const originalHTML = button.innerHTML;
        button.innerHTML = '<i class="fas fa-check me-1"></i> Copied!';
        button.classList.remove('btn-outline-secondary');
        button.classList.add('btn-success');

        setTimeout(() => {
            button.innerHTML = originalHTML;
            button.classList.remove('btn-success');
            button.classList.add('btn-outline-secondary');
        }, 2000);
    }
</script>
{% endblock %}

